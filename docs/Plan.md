# План автоматизации тестирования комплексного сервиса, взаимодействующего с СУБД и API Банка.

## 1. Введение.

* Будет проводиться автоматизация тестирования веб-сервиса, предоставляющего возможность покупки тура по определённой
  цене с помощью дебетовой карты или кредита. Покупка производиться путём указания данных карты в веб форме.
* Критериями успешного тестирования являются:
    * Возможность купить тур при корректном заполнении формы с использованием карты.
    * Невозможность купить тур и получение уведомлений о некорректном заполнении полей формы.

___

## 2. Виды тестирования.

1. Тестирование веб-интерфейса.
2. Тестирование API.
3. Интеграционное тестирование.


___

## 3. Перечень автоматизируемых сценариев.
### Валидные данные для формы оплаты:
* Поле "Номер карты": ввод цифрового значения (всего 16 символов).
* Поле "Месяц": ввод двухзначного значения (от 01 до 12 включительно), месяц должен иметь значение не менее текущего месяца, если год действия карты - текущий год.
* Поле "Год": ввод цифрового двухзначного значения(год не должен иметь значение меньше значения текущего года и не превышать 5 лет от текущего года).
* Поле "Владелец": буквы латинского алфавита не менее 1 символа.
* Поле "CVC/CVV": цифровое трёхзначное число (от 000 до 999).

### Тестовые данные:

* Банковская карта (далее "карта"), для оплаты с номером "4444 4444 4444 4441", статус "APPROVED".
* Банковская карта (далее "карта"), для оплаты с номером "4444 4444 4444 4442", статус "DECLINED".

### Предусловие:
1. Открыть сайт "Путешествие дня" http://localhost:8080
1. Выбрать один из способов покупки тура:
* 1 вариант: с карты - нажать кнопку «Купить».
* 2 вариант: в кредит - нажать кнопку «Купить в кредит».

### **Тестирование веб-интерфейса.**

### Вариант 1 : "Купить".

Сценарий 1.1 "Успешная покупка".

* Номер карты: "4444 4444 4444 4441" (status: APPROVED).
* Месяц от "01 до 12" и год "от текущий до + 4 года", таким образом, чтобы в совокупности дата окончания действия карты.
  была больше текущей даты.
* Владелец: как на карте, заглавные латинские буквы через пробел "NAME SURNAME".
* CVC/CVV код: три цифры.
* Нажать кнопку "Продолжить".
* Ожидаемый результат:
    * запрос в банк отправляется.
    * уведомление "Операция одобрена банком".
    * В БД добавилась запись со статусом APPROVED.

Сценарий 1.2 "Карта отклонена".

* Повторить Сценарий 1.1, используя номер карты: "4444 4444 4444 4442" (status: DECLINED)
* Ожидаемый результат:
    * запрос в банк отправляется
    * уведомление "Ошибка! Банк отказал в проведении операции."
    * В БД добавилась запись со статусом DECLINED.

Сценарий 1.3 "Карта другого банка отклонена"

* Повторить Сценарий 1.1, используя номер карты другого банка: "4156 1080 4564 6238".
* Ожидаемый результат:
    * запрос в банк отправляется.
    * уведомление "Ошибка! Банк отказал в проведении операции."

Сценарий 1.4 "Пустые поля"

* Нажать кнопку "Продолжить" при пустых полях.
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение в поле "Владелец": "Поле обязательно для заполнения".
    * в остальных полях предупреждение: "Неверный формат".
    
Сценарий 1.5."Пустое поле Номер карты".
* Повторить сценарий 1.1. оставив поле "Номер карты" незаполненной.
* Ожидаемый результат:
   * Под полем "Номер карты" появляется предупреждение "Поле обязательно для заполнения". 

Сценарий 1.6. "Неполный номер карты 15 знаков"

* Повторить Сценарий 1.1, используя неполный номер карты: "4444 4444 4444 444".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверный формат".

Сценарий 1.7. "Неполный номер карты- 1 знак".

* Повторить Сценарий 1.1, используя неполный номер карты: "4".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверный формат".
    
Сценарий 1.8. "Пустое поле Месяц".
* Повторить сценарий 1.1. оставив поле "Месяц" незаполненной.
* Ожидаемый результат:
   * Под полем "Месяц" появляется предупреждение "Поле обязательно для заполнения". 

Сценарий 1.9. "Некорректный номер месяца- 1 знак"

* Повторить Сценарий 1.1, используя номер месяца "0"
* Ожидаемый результат:
    * запрос в банк не отправляется
    * предупреждение "Неверный формат"

Сценарий 1.10. "Некорректный номер месяца- 2 ноля"

* Повторить Сценарий 1.1, используя номер месяца "00".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверный формат".

Сценарий 1.11. "Некорректный номер месяца- больше 12".

* Повторить Сценарий 1.1, используя номер месяца больше "от 13 до 99".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверно указан срок действия карты".

Сценарий 1.12. "Некорректный номер месяца- прошлый месяц".

* Повторить Сценарий 1.1, используя текущий год и прошлый номер месяца
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Истёк срок действия карты".

Сценарий 1.13. "Пустое поле Год".
* Повторить сценарий 1.1. оставив поле "Год" незаполненной.
* Ожидаемый результат:
   * Под полем "Год" появляется предупреждение "Поле обязательно для заполнения". 

Сценарий 1.14. "Некорректный номер года- 0".

* Повторить Сценарий 1.1, используя номер года "0".
* Ожидаемый результат:
    * запрос в банк не отправляется
    * предупреждение "Неверный формат"

Сценарий 1.15. "Некорректный номер года- 2 ноля"

* Повторить Сценарий 1.1, используя номер года "00".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверный формат".

Сценарий 1.16. "Некорректный номер года- прошлый год".

* Повторить Сценарий 1.1, используя текущий месяц и прошлый номер года.
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Истёк срок действия карты".

Сценарий 1.17. "Некорректный номер года- более 6 лет".

* Повторить Сценарий 1.1, используя год окончания действия карты "через 6 и более лет от текущего".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверно указан срок действия карты".

Сценарий 1.18. "Пустое поле владелец".
* Повторить сценарий 1.1. оставив поле "Владелец" незаполненной.
* Ожидаемый результат:
   * Под полем "Владелец" появляется предупреждение "Поле обязательно для заполнения". 

Сценарий 1.19. "Некорректное имя владельца"

* Повторить Сценарий 1.1, используя имя отличное от формата "NAME SURNAME".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверный формат".

Сценарий 1.20. "Пустое поле CVC/CVC".
* Повторить сценарий 1.1. оставив поле "CVC/CVC" незаполненной.
* Ожидаемый результат:
   * Под полем "CVC/CVC" появляется предупреждение "Поле обязательно для заполнения". 

Сценарий 1.21. "Некорректный номер CVC/CVV".

* Повторить Сценарий 1.1, используя CVC/CVV "от 0 до 99".
* Ожидаемый результат:
    * запрос в банк не отправляется.
    * предупреждение "Неверный формат".

Сценарий 1.22. "Некорректный номер CVC/CVV- 3 ноля".

* Повторить Сценарий 1.1, используя CVC/CVV "000"
* Ожидаемый результат:
    * запрос в банк не отправляется
    * предупреждение "Неверный формат"

### Вариант 2 : "Купить в кредит"

Сценарий 2.1 "Успешная покупка в кредит, используя карту "4444 4444 4444 4441" status: APPROVED"

* Повторить Сценарий 1.1
* Ожидаемый результат:
    * запрос в банк отправляется
    * уведомление "Операция одобрена Банком"

Сценарий 2.2 "Покупка в кредит через карту "4444 4444 4444 4442" status: DECLINED"

* Повторить Сценарий 1.2
* Ожидаемый результат:
    * запрос в банк отправляется
    * уведомление "Ошибка! Банк отказал в проведении операции"

    Сценарии 2.3.-2.22. аналогично сценариям 1.3.-1.22. варианта 1.

### **API - тестирование**

Сценарий 3.1

* POST запрос по адресу http://localhost:8080/api/v1/pay
* {number: "4444 4444 4444 4441", year: "24", month: "12", holder: "IVAN TORIN", cvc: "666"}
* ожидаемый результат:
    * код 200 OK
    * response "status: APPROVED"
   

Сценарий 3.2

* POST запрос по адресу http://localhost:8080/api/v1/pay
* {number: "4444 4444 4444 4442", year: "24", month: "12", holder: "IVAN TORIN", cvc: "666"}
    * ожидаемый результат:
    * код 200 OK
    * response "status: DECLINED"
  

Сценарий 3.3

* POST запрос по адресу http://localhost:8080/api/v1/credit
* {number: "4444 4444 4444 4441", year: "22", month: "12", holder: "IVAN TORIN", cvc: "777"}
* ожидаемый результат:
    * код 200 OK
    * response "status: APPROVED"



Сценарий 3.4.

* POST запрос по адресу http://localhost:8080/api/v1/credit
* {number: "4444 4444 4444 4442", year: "24", month: "12", holder: "IVAN TORIN", cvc: "777"}
* ожидаемый результат:
    * код 200 OK
    * response "status: DECLINED".
  


Сценарий 3.5.

* POST запрос по адресу http://localhost:8080/api/v1/pay
* {number: "4444 6654 3455 1256", year: "24", month: "12", holder: "IVAN TORIN", cvc: "888"}
* ожидаемый результат:
    * код 400




Сценарий 3.6.

* POST запрос по адресу http://localhost:8080/api/v1/credit
* {number: "4444 6654 3455 1256", year: "24", month: "12", holder: "IVAN TORIN", cvc: "888"}
* ожидаемый результат:
    * код 400.
    


___

## 4. Перечень используемых инструментов:
* Java 11 - версия в которой разрабатывается ПО.
* IntelliJ IDEA - удобная среда разработки для JAVA.
* Gradle - популярная система автоматической сборки.
* JUnit 5 - вложенные и параметризованные тесты.
* Selenide - управление браузером и создание автоматических скриншотов.
* Faker - генерация пользовательских данных.
* Docker - система для быстрого развёртывания и перезапуска базы данных.
* Git - система контроля версий.
* GitHub - удалённое хранилище проекта.
* Reporting.Allure - автоматическое создание отчётов.
* GitHub.Actions - система CI CD.
* REST Assured - Java DSL (Domain Specific Languages) для упрощения тестирования служб на основе REST, построенных на
  основе HTTP Builder. Он поддерживает запросы POST, GET, PUT, DELETE, OPTIONS, PATCH и HEAD и может использоваться для
  верификации и валидации ответа на эти запросы.
* DbUtils - набор классов, предназначенный для упрощения работы с JDBC. Основные классы / интерфейсы в DbUtils - это
  QueryRunner и ResultSetHandler.
* Lombok - плагин, предоставляет аннотации, позволяющие сократить время написания кода
* Appveyor - система CI CD.

___

## 5. Перечень и описание возможных рисков при автоматизации

* Высокая стоимость используемых инструментов
* Необходимость поддержки тестов

___

## 6. Интервальная оценка с учётом рисков (в часах)

* Разработка плана тестирования - 10 часов;
* Развёртывание окружения - 4 часа;
* Написание авто-тестов - 30 часов;
* Баг-репорты - 5 часов;
* Подготовка отчета о тестировании - 5 часов;
* Подготовка отчета о проделанной работе - 2 часа.

___

* **Итого:** 56 часа

___

## 7. План сдачи работ

* Написание кода и тестов - 12 рабочих дней после окончательного утверждения плана;
* Отчёты - 3 рабочий день после код ревью.
